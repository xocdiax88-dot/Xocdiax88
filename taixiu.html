<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Flappy Bird VIP</title>
<style>
body{
    margin:0;
    background:#70c5ce;
    overflow:hidden;
    font-family:Arial;
    text-align:center;
}
canvas{
    background:#70c5ce;
    display:block;
    margin:auto;
}
#score{
    position:absolute;
    top:20px;
    width:100%;
    font-size:30px;
    color:white;
    font-weight:bold;
}
</style>
</head>
<body>

<div id="score">0</div>
<canvas id="game" width="400" height="600"></canvas>

<script>
let canvas = document.getElementById("game");
let ctx = canvas.getContext("2d");

let bird = {
    x:80,
    y:200,
    size:20,
    gravity:0.6,
    lift:-10,
    velocity:0
};

let pipes = [];
let frame = 0;
let score = 0;
let gameOver = false;

function drawBird(){
    ctx.fillStyle="yellow";
    ctx.beginPath();
    ctx.arc(bird.x,bird.y,bird.size,0,Math.PI*2);
    ctx.fill();
}

function drawPipes(){
    ctx.fillStyle="green";
    pipes.forEach(pipe=>{
        ctx.fillRect(pipe.x,0,50,pipe.top);
        ctx.fillRect(pipe.x,pipe.bottom,50,600);
    });
}

function update(){
    if(gameOver) return;

    bird.velocity += bird.gravity;
    bird.y += bird.velocity;

    if(frame % 90 === 0){
        let top = Math.random()*300+50;
        let gap = 150;
        pipes.push({
            x:400,
            top:top,
            bottom:top+gap
        });
    }

    pipes.forEach(pipe=>{
        pipe.x -= 3;

        if(pipe.x === bird.x){
            score++;
            document.getElementById("score").innerText = score;
        }

        if(
            bird.x < pipe.x + 50 &&
            bird.x + bird.size > pipe.x &&
            (bird.y - bird.size < pipe.top ||
             bird.y + bird.size > pipe.bottom)
        ){
            gameOver = true;
            alert("Game Over! Điểm: " + score);
            location.reload();
        }
    });

    if(bird.y > 600 || bird.y < 0){
        gameOver = true;
        alert("Game Over! Điểm: " + score);
        location.reload();
    }

    frame++;
}

function draw(){
    ctx.clearRect(0,0,400,600);
    drawBird();
    drawPipes();
}

function loop(){
    update();
    draw();
    requestAnimationFrame(loop);
}

document.addEventListener("click",()=>{
    bird.velocity = bird.lift;
});

loop();
</script>

</body>
</html>
