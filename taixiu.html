<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Flappy Bird VIP</title>
<style>
body{
    margin:0;
    background:#70c5ce;
    font-family:Arial;
    display:flex;
    flex-direction:column;
    height:100vh;
}

/* Màn hình game phía trên */
#gameContainer{
    flex:1;
    position:relative;
}

canvas{
    display:block;
    margin:auto;
    background:#70c5ce;
}

/* Nút tròn phía dưới */
#control{
    height:140px;
    display:flex;
    justify-content:center;
    align-items:center;
    background:#5faeb5;
}

#jumpBtn{
    width:100px;
    height:100px;
    border-radius:50%;
    border:none;
    font-size:20px;
    background:white;
    box-shadow:0 5px 15px rgba(0,0,0,0.4);
}

#score{
    position:absolute;
    top:10px;
    width:100%;
    text-align:center;
    font-size:28px;
    color:white;
    font-weight:bold;
}
</style>
</head>
<body>

<div id="gameContainer">
    <div id="score">0</div>
    <canvas id="game" width="400" height="500"></canvas>
</div>

<div id="control">
    <button id="jumpBtn">NHẢY</button>
</div>

<script>
let canvas = document.getElementById("game");
let ctx = canvas.getContext("2d");

let bird = {
    x:80,
    y:250,
    size:20,
    gravity:0.6,
    lift:-10,
    velocity:0
};

let pipes = [];
let frame = 0;
let score = 0;
let gameOver = false;

function drawBird(){
    ctx.fillStyle="yellow";
    ctx.beginPath();
    ctx.arc(bird.x,bird.y,bird.size,0,Math.PI*2);
    ctx.fill();
}

function drawPipes(){
    ctx.fillStyle="green";
    pipes.forEach(pipe=>{
        ctx.fillRect(pipe.x,0,60,pipe.top);
        ctx.fillRect(pipe.x,pipe.bottom,60,500);
    });
}

function update(){
    if(gameOver) return;

    bird.velocity += bird.gravity;
    bird.y += bird.velocity;

    if(frame % 90 === 0){
        let top = Math.random()*200+50;
        let gap = 140;
        pipes.push({
            x:400,
            top:top,
            bottom:top+gap,
            passed:false
        });
    }

    pipes.forEach(pipe=>{
        pipe.x -= 3;

        if(!pipe.passed && pipe.x < bird.x){
            score++;
            document.getElementById("score").innerText = score;
            pipe.passed = true;
        }

        if(
            bird.x + bird.size > pipe.x &&
            bird.x - bird.size < pipe.x + 60 &&
            (bird.y - bird.size < pipe.top ||
             bird.y + bird.size > pipe.bottom)
        ){
            endGame();
        }
    });

    if(bird.y > 500 || bird.y < 0){
        endGame();
    }

    frame++;
}

function draw(){
    ctx.clearRect(0,0,400,500);
    drawBird();
    drawPipes();
}

function loop(){
    update();
    draw();
    requestAnimationFrame(loop);
}

function jump(){
    if(!gameOver){
        bird.velocity = bird.lift;
    }
}

document.getElementById("jumpBtn").addEventListener("click", jump);

function endGame(){
    gameOver = true;
    alert("Game Over! Điểm: " + score);
    location.reload();
}

loop();
</script>

</body>
</html>
